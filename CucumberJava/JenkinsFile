pipeline {
    agent { 
     dockerfile
            { filename 'Dockerfile'
              args '-u root -v /root/.m2:/root/.m2/repository'   
            
            }
          }
    stages {
        stage('Source') {
            steps {
                sh 'mvn --version'
                sh 'git --version'
                git branch: 'master',
                    url: 'https://github.com/lokeshsampath/JenkinsTest.git'
            }
        }
        stage('Test') {
            steps {   
                    dir("${env.WORKSPACE}/CucumberJava")
                    {
                    sh "chmod +x src/test/resources/drivers/chromedriver"
                    sh 'mvn -e clean test' }
            }
        } 
        stage("Reports") {
      steps {
         dir("${env.WORKSPACE}/CucumberJava") 
         {
        cucumber buildStatus: 'null',
          customCssFiles: '',
          customJsFiles: '',
          failedFeaturesNumber: -1,
          failedScenariosNumber: -1,
          failedStepsNumber: -1,
          fileIncludePattern: '**/*.json',
          jsonReportDirectory: 'target/JSONReports',
          pendingStepsNumber: -1,
          skippedStepsNumber: -1,
          sortingMethod: 'ALPHABETICAL',
          undefinedStepsNumber: -1
          }
      }
    }
    }
}
